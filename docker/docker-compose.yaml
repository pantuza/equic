version: "3"

services:

  server:
    container_name: equic-server
    image: equic:local
    command: tail -f
    volumes:
      - ..:/src/equic
      - ../CMakeLists.txt:/src/lsquic/CMakeLists.txt
      - ../echo_server.c:/src/lsquic/bin/echo_server.c
      - ../http_server.c:/src/lsquic/bin/http_server.c
    cap_add: # Necessary to modify network interface
      - NET_ADMIN
      - SYS_ADMIN
    networks:
      - equic
    restart: always

  client1:
    container_name: equic-client-1
    image: equic:local
    command: tail -f
    volumes:
      - ..:/src/equic
    networks:
      - equic

  client2:
    container_name: equic-client-2
    image: equic:local
    command: tail -f
    volumes:
      - ..:/src/equic
    networks:
      - equic

networks:
  equic:
